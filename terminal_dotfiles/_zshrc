# Skip all this for non-interactive shells
[[ -z "$PS1" ]] && return


# Set up the prompt
if [ -n "$DISPLAY" -a "$TERM" = "xterm" ]; then
  export TERM=xterm-256color
fi

if [[ $TERM == "xterm-256color" || $TERM == "screen-256color" ]]; then
  source ~/myubuntu/powerline/powerline/bindings/zsh/powerline.zsh
else
  autoload -Uz promptinit
  promptinit
  prompt adam1
fi


setopt histignorealldups sharehistory

# Use vi keybindings
bindkey -v

# Keep 10000 lines of history within the shell and save it to ~/.zsh_history:
export HISTSIZE=10000
export SAVEHIST=$HISTSIZE
setopt HIST_IGNORE_ALL_DUPS
setopt HIST_REDUCE_BLANKS
setopt SHARE_HISTORY
setopt HIST_FCNTL_LOCK
setopt HIST_LEX_WORDS
setopt EXTENDED_GLOB

# Use modern completion system
autoload -Uz compinit
compinit

# zsh autocompletion
fpath=($HOME/myubuntu/zsh-completions/src $fpath)

# SSH hosts completion {{{
[[ -f ~/.ssh/config ]] && : ${(A)SSHh_config_hosts:=${${${${(@M)${(f)"$(<~/.ssh/config)"}:#Host *}#Host }:#*\**}:#*\?*}}
zstyle ':completion:*:*:*' hosts $ssh_config_hosts
zstyle ':completion:*' auto-description 'specify: %d'
zstyle ':completion:*' completer _expand _complete _correct _approximate
zstyle ':completion:*' format 'Completing %d'
zstyle ':completion:*' group-name ''
zstyle ':completion:*' menu select=2
eval "$(dircolors -b)"
zstyle ':completion:*:default' list-colors ${(s.:.)LS_COLORS}
zstyle ':completion:*' list-colors ''
zstyle ':completion:*' list-prompt %SAt %p: Hit TAB for more, or the character to insert%s
zstyle ':completion:*' matcher-list '' 'm:{a-z}={A-Z}' 'm:{a-zA-Z}={A-Za-z}' 'r:|[._-]=* r:|=* l:|=*'
zstyle ':completion:*' menu select=long
zstyle ':completion:*' select-prompt %SScrolling active: current selection at %p%s
zstyle ':completion:*' use-compctl false
zstyle ':completion:*' verbose true

zstyle ':completion:*:*:kill:*:processes' list-colors '=(#b) #([0-9]#)*=0=01;31'
zstyle ':completion:*:kill:*' command 'ps -u $USER -o pid,%cpu,tty,cputime,cmd'

. ~/.aliases
# why would you type 'cd dir' if you could just type 'dir'?
setopt AUTO_CD
function chpwd() {
  emulate -L zsh
  la
}

# beeps are annoying
setopt NO_BEEP

# Syntax highlighting
source $HOME/.zsh_highlight

# More PATH
SCRIPTS=$HOME/.scripts
POWERLINE_SCRIPT_DIR=$HOME/myubuntu/powerline/scripts
# Prevent tmux from export the path again
if [ "$_SKIP_PROFILE" ]
then
  return 0
else
  export _SKIP_PROFILE=y
fi
# No need to add java if it is not installed
export PATH=$PATH:$SCRIPTS:$POWERLINE_SCRIPT_DIR
